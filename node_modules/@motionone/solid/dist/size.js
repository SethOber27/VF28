import{createComponent as t,mergeProps as e,Dynamic as n,memo as i}from"solid-js/web";import{createMemo as r,untrack as o,createSignal as a,useTransition as s,createComputed as c,batch as l,createContext as u,useContext as f,splitProps as h,onMount as p,onCleanup as d,createEffect as m}from"solid-js";function y(t,e){-1===t.indexOf(e)&&t.push(e)}const v=(t,e,n)=>Math.min(Math.max(n,t),e),g={duration:.3,delay:0,endDelay:0,repeat:0,easing:"ease"},b=t=>"number"==typeof t,w=t=>Array.isArray(t)&&!b(t[0]);const E=(t,e,n)=>-n*t+n*e+t,O=()=>{},A=t=>t,x=(t,e,n)=>e-t==0?1:(n-t)/(e-t);function S(t,e){const n=t[t.length-1];for(let i=1;i<=e;i++){const r=x(0,e,i);t.push(E(n,1,r))}}function T(t,e=function(t){const e=[0];return S(e,t-1),e}(t.length),n=A){const i=t.length,r=i-e.length;return r>0&&S(e,r),r=>{let o=0;for(;o<i-2&&!(r<e[o+1]);o++);let a=v(0,1,x(e[o],e[o+1],r));const s=function(t,e){return w(t)?t[((t,e,n)=>{const i=e-t;return((n-t)%i+i)%i+t})(0,t.length,e)]:t}(n,o);return a=s(a),E(t[o],t[o+1],a)}}const D=t=>Array.isArray(t)&&b(t[0]),j=t=>"object"==typeof t&&Boolean(t.createAnimation),M=t=>"function"==typeof t,P=t=>1e3*t,k=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t;function V(t,e,n,i){if(t===e&&n===i)return A;const r=e=>function(t,e,n,i,r){let o,a,s=0;do{a=e+(n-e)/2,o=k(a,i,r)-t,o>0?n=a:e=a}while(Math.abs(o)>1e-7&&++s<12);return a}(e,0,1,t,n);return t=>0===t||1===t?t:k(r(t),e,i)}const L={ease:V(.25,.1,.25,1),"ease-in":V(.42,0,1,1),"ease-in-out":V(.42,0,.58,1),"ease-out":V(0,0,.58,1)},C=/\((.*?)\)/;function R(t){if(M(t))return t;if(D(t))return V(...t);if(L[t])return L[t];if(t.startsWith("steps")){const e=C.exec(t);if(e){const t=e[1].split(",");return((t,e="end")=>n=>{const i=(n="end"===e?Math.min(n,.999):Math.max(n,.001))*t,r="end"===e?Math.floor(i):Math.ceil(i);return v(0,1,r/t)})(parseFloat(t[0]),t[1].trim())}}return A}class ${constructor(t,e=[0,1],{easing:n,duration:i=g.duration,delay:r=g.delay,endDelay:o=g.endDelay,repeat:a=g.repeat,offset:s,direction:c="normal"}={}){if(this.startTime=null,this.rate=1,this.t=0,this.cancelTimestamp=null,this.easing=A,this.duration=0,this.totalDuration=0,this.repeat=0,this.playState="idle",this.finished=new Promise(((t,e)=>{this.resolve=t,this.reject=e})),n=n||g.easing,j(n)){const t=n.createAnimation(e);n=t.easing,e=t.keyframes||e,i=t.duration||i}this.repeat=a,this.easing=w(n)?A:R(n),this.updateDuration(i);const l=T(e,s,w(n)?n.map(R):A);this.tick=e=>{var n;let i=0;i=void 0!==this.pauseTime?this.pauseTime:(e-this.startTime)*this.rate,this.t=i,i/=1e3,i=Math.max(i-r,0),"finished"===this.playState&&void 0===this.pauseTime&&(i=this.totalDuration);const a=i/this.duration;let s=Math.floor(a),u=a%1;!u&&a>=1&&(u=1),1===u&&s--;const f=s%2;("reverse"===c||"alternate"===c&&f||"alternate-reverse"===c&&!f)&&(u=1-u);const h=i>=this.totalDuration?1:Math.min(u,1),p=l(this.easing(h));t(p);void 0===this.pauseTime&&("finished"===this.playState||i>=this.totalDuration+o)?(this.playState="finished",null===(n=this.resolve)||void 0===n||n.call(this,p)):"idle"!==this.playState&&(this.frameRequestId=requestAnimationFrame(this.tick))},this.play()}play(){const t=performance.now();this.playState="running",void 0!==this.pauseTime?this.startTime=t-this.pauseTime:this.startTime||(this.startTime=t),this.cancelTimestamp=this.startTime,this.pauseTime=void 0,this.frameRequestId=requestAnimationFrame(this.tick)}pause(){this.playState="paused",this.pauseTime=this.t}finish(){this.playState="finished",this.tick(0)}stop(){var t;this.playState="idle",void 0!==this.frameRequestId&&cancelAnimationFrame(this.frameRequestId),null===(t=this.reject)||void 0===t||t.call(this,!1)}cancel(){this.stop(),this.tick(this.cancelTimestamp)}reverse(){this.rate*=-1}commitStyles(){}updateDuration(t){this.duration=t,this.totalDuration=t*(this.repeat+1)}get currentTime(){return this.t}set currentTime(t){void 0!==this.pauseTime||0===this.rate?this.pauseTime=t:this.startTime=performance.now()-t/this.rate}get playbackRate(){return this.rate}set playbackRate(t){this.rate=t}}var B=function(){};"production"!==process.env.NODE_ENV&&(B=function(t,e){if(!t)throw new Error(e)});class I{setAnimation(t){this.animation=t,null==t||t.finished.then((()=>this.clearAnimation())).catch((()=>{}))}clearAnimation(){this.animation=this.generator=void 0}}const q=new WeakMap;function U(t){return q.has(t)||q.set(t,{transforms:[],values:new Map}),q.get(t)}const F=["","X","Y","Z"],W={x:"translateX",y:"translateY",z:"translateZ"},_={syntax:"<angle>",initialValue:"0deg",toDefaultUnit:t=>t+"deg"},z={translate:{syntax:"<length-percentage>",initialValue:"0px",toDefaultUnit:t=>t+"px"},rotate:_,scale:{syntax:"<number>",initialValue:1,toDefaultUnit:A},skew:_},H=new Map,N=t=>`--motion-${t}`,K=["x","y","z"];["translate","scale","rotate","skew"].forEach((t=>{F.forEach((e=>{K.push(t+e),H.set(N(t+e),z[t])}))}));const X=(t,e)=>K.indexOf(t)-K.indexOf(e),Y=new Set(K),Z=t=>Y.has(t),G=t=>t.sort(X).reduce(J,"").trim(),J=(t,e)=>`${t} ${e}(var(${N(e)}))`,Q=t=>t.startsWith("--"),tt=new Set;const et=(t,e)=>document.createElement("div").animate(t,e),nt={cssRegisterProperty:()=>"undefined"!=typeof CSS&&Object.hasOwnProperty.call(CSS,"registerProperty"),waapi:()=>Object.hasOwnProperty.call(Element.prototype,"animate"),partialKeyframes:()=>{try{et({opacity:[1]})}catch(t){return!1}return!0},finished:()=>Boolean(et({opacity:[0,1]},{duration:.001}).finished),linearEasing:()=>{try{et({opacity:0},{easing:"linear(0, 1)"})}catch(t){return!1}return!0}},it={},rt={};for(const t in nt)rt[t]=()=>(void 0===it[t]&&(it[t]=nt[t]()),it[t]);const ot=(t,e)=>M(t)?rt.linearEasing()?`linear(${((t,e)=>{let n="";const i=Math.round(e/.015);for(let e=0;e<i;e++)n+=t(x(0,i-1,e))+", ";return n.substring(0,n.length-2)})(t,e)})`:g.easing:D(t)?at(t):t,at=([t,e,n,i])=>`cubic-bezier(${t}, ${e}, ${n}, ${i})`;function st(t){return W[t]&&(t=W[t]),Z(t)?N(t):t}const ct=(t,e)=>{e=st(e);let n=Q(e)?t.style.getPropertyValue(e):getComputedStyle(t)[e];if(!n&&0!==n){const t=H.get(e);t&&(n=t.initialValue)}return n},lt=(t,e,n)=>{e=st(e),Q(e)?t.style.setProperty(e,n):t.style[e]=n};function ut(t,e,n,i={},r){const o=window.__MOTION_DEV_TOOLS_RECORD,a=!1!==i.record&&o;let s,{duration:c=g.duration,delay:l=g.delay,endDelay:u=g.endDelay,repeat:f=g.repeat,easing:h=g.easing,persist:p=!1,direction:d,offset:m,allowWebkitAcceleration:v=!1}=i;const E=U(t),x=Z(e);let S=rt.waapi();x&&((t,e)=>{W[e]&&(e=W[e]);const{transforms:n}=U(t);y(n,e),t.style.transform=G(n)})(t,e);const T=st(e),D=function(t,e){return t.has(e)||t.set(e,new I),t.get(e)}(E.values,T),k=H.get(T);return function(t,e=!0){if(t&&"finished"!==t.playState)try{t.stop?t.stop():(e&&t.commitStyles(),t.cancel())}catch(t){}}(D.animation,!(j(h)&&D.generator)&&!1!==i.record),()=>{const y=()=>{var e,n;return null!==(n=null!==(e=ct(t,T))&&void 0!==e?e:null==k?void 0:k.initialValue)&&void 0!==n?n:0};let g=function(t,e){for(let n=0;n<t.length;n++)null===t[n]&&(t[n]=n?t[n-1]:e());return t}((t=>Array.isArray(t)?t:[t])(n),y);const E=function(t,e){var n;let i=(null==e?void 0:e.toDefaultUnit)||A;const r=t[t.length-1];if("string"==typeof r){const t=(null===(n=r.match(/(-?[\d.]+)([a-z%]*)/))||void 0===n?void 0:n[2])||"";t&&(i=e=>e+t)}return i}(g,k);if(j(h)){const t=h.createAnimation(g,"opacity"!==e,y,T,D);h=t.easing,g=t.keyframes||g,c=t.duration||c}if(Q(T)&&(rt.cssRegisterProperty()?function(t){if(!tt.has(t)){tt.add(t);try{const{syntax:e,initialValue:n}=H.has(t)?H.get(t):{};CSS.registerProperty({name:t,inherits:!1,syntax:e,initialValue:n})}catch(t){}}}(T):S=!1),x&&!rt.linearEasing()&&(M(h)||w(h)&&h.some(M))&&(S=!1),S){k&&(g=g.map((t=>b(t)?k.toDefaultUnit(t):t))),1!==g.length||rt.partialKeyframes()&&!a||g.unshift(y());const e={delay:P(l),duration:P(c),endDelay:P(u),easing:w(h)?void 0:ot(h,c),direction:d,iterations:f+1,fill:"both"};s=t.animate({[T]:g,offset:m,easing:w(h)?h.map((t=>ot(t,c))):void 0},e),s.finished||(s.finished=new Promise(((t,e)=>{s.onfinish=t,s.oncancel=e})));const n=g[g.length-1];s.finished.then((()=>{p||(lt(t,T,n),s.cancel())})).catch(O),v||(s.playbackRate=1.000001)}else if(r&&x)g=g.map((t=>"string"==typeof t?parseFloat(t):t)),1===g.length&&g.unshift(parseFloat(y())),s=new r((e=>{lt(t,T,E?E(e):e)}),g,Object.assign(Object.assign({},i),{duration:c,easing:h}));else{const e=g[g.length-1];lt(t,T,k&&b(e)?k.toDefaultUnit(e):e)}return a&&o(t,e,g,{duration:c,delay:l,easing:h,repeat:f,offset:m},"motion-one"),D.setAnimation(s),s}}const ft=(t,e)=>t[e]?Object.assign(Object.assign({},t),t[e]):Object.assign({},t);function ht(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]])}return n}const pt={any:0,all:1};function dt(t,e,{root:n,margin:i,amount:r="any"}={}){if("undefined"==typeof IntersectionObserver)return()=>{};const o=function(t,e){var n;return"string"==typeof t?e?(null!==(n=e[t])&&void 0!==n||(e[t]=document.querySelectorAll(t)),t=e[t]):t=document.querySelectorAll(t):t instanceof Element&&(t=[t]),Array.from(t||[])}(t),a=new WeakMap,s=new IntersectionObserver((t=>{t.forEach((t=>{const n=a.get(t.target);if(t.isIntersecting!==Boolean(n))if(t.isIntersecting){const n=e(t);M(n)?a.set(t.target,n):s.unobserve(t.target)}else n&&(n(t),a.delete(t.target))}))}),{root:n,rootMargin:i,threshold:"number"==typeof r?r:pt[r]});return o.forEach((t=>s.observe(t))),()=>s.disconnect()}function mt(t,e){return function(t){return"object"==typeof t}(t)?t:t&&e?e[t]:void 0}let yt;function vt(){if(!yt)return;const t=yt.sort(bt).map(wt);t.forEach(Et),t.forEach(Et),yt=void 0}function gt(t){yt?y(yt,t):(yt=[t],requestAnimationFrame(vt))}const bt=(t,e)=>t.getDepth()-e.getDepth(),wt=t=>t.animateUpdates(),Et=t=>t.next(),Ot=(t,e)=>new CustomEvent(t,{detail:{target:e}});function At(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:{originalEvent:n}}))}function xt(t,e,n){t.dispatchEvent(new CustomEvent(e,{detail:{originalEntry:n}}))}const St=(t,e,n)=>i=>{i.pointerType&&"mouse"!==i.pointerType||(n(),At(t,e,i))},Tt={inView:{isActive:t=>Boolean(t.inView),subscribe:(t,{enable:e,disable:n},{inViewOptions:i={}})=>{const{once:r}=i,o=ht(i,["once"]);return dt(t,(i=>{if(e(),xt(t,"viewenter",i),!r)return e=>{n(),xt(t,"viewleave",e)}}),o)}},hover:{isActive:t=>Boolean(t.hover),subscribe:(t,{enable:e,disable:n})=>{const i=St(t,"hoverstart",e),r=St(t,"hoverend",n);return t.addEventListener("pointerenter",i),t.addEventListener("pointerleave",r),()=>{t.removeEventListener("pointerenter",i),t.removeEventListener("pointerleave",r)}}},press:{isActive:t=>Boolean(t.press),subscribe:(t,{enable:e,disable:n})=>{const i=e=>{n(),At(t,"pressend",e),window.removeEventListener("pointerup",i)},r=n=>{e(),At(t,"pressstart",n),window.addEventListener("pointerup",i)};return t.addEventListener("pointerdown",r),()=>{t.removeEventListener("pointerdown",r),window.removeEventListener("pointerup",i)}}}},Dt=["initial","animate",...Object.keys(Tt),"exit"],jt=new WeakMap;function Mt(t={},e){let n,i=e?e.getDepth()+1:0;const r={initial:!0,animate:!0},o={},a={};for(const n of Dt)a[n]="string"==typeof t[n]?t[n]:null==e?void 0:e.getContext()[n];const s=!1===t.initial?"animate":"initial";let c=ht(mt(t[s]||a[s],t.variants)||{},["transition"]);const l=Object.assign({},c);const u=(t,e)=>()=>{r[t]=e,gt(h)},f=()=>{for(const e in Tt){const i=Tt[e].isActive(t),r=o[e];i&&!r?o[e]=Tt[e].subscribe(n,{enable:u(e,!0),disable:u(e,!1)},t):!i&&r&&(r(),delete o[e])}},h={update:e=>{n&&(t=e,f(),gt(h))},setActive:(t,e)=>{n&&(r[t]=e,gt(h))},animateUpdates:function*(){var e,i;const o=c;c={};const a={};for(const n of Dt){if(!r[n])continue;const o=mt(t[n]);if(o)for(const n in o)"transition"!==n&&(c[n]=o[n],a[n]=ft(null!==(i=null!==(e=o.transition)&&void 0!==e?e:t.transition)&&void 0!==i?i:{},n))}const s=new Set([...Object.keys(c),...Object.keys(o)]),u=[];s.forEach((t=>{var e,i,r;void 0===c[t]&&(c[t]=l[t]),i=o[t],r=c[t],typeof i==typeof r&&(Array.isArray(i)&&Array.isArray(r)?function(t,e){const n=e.length;if(n!==t.length)return!1;for(let i=0;i<n;i++)if(e[i]!==t[i])return!1;return!0}(i,r):i===r)||(null!==(e=l[t])&&void 0!==e||(l[t]=ct(n,t)),u.push(ut(n,t,c[t],a[t],$)))})),yield;const f=u.map((t=>t())).filter(Boolean);if(!f.length)return;const h=c;n.dispatchEvent(Ot("motionstart",h)),Promise.all(f.map((t=>t.finished))).then((()=>{n.dispatchEvent(Ot("motioncomplete",h))})).catch(O)},getDepth:()=>i,getTarget:()=>c,getOptions:()=>t,getContext:()=>a,mount:t=>(B(Boolean(t),"Animation state must be mounted with valid Element"),n=t,jt.set(n,h),f(),()=>{jt.delete(n),function(t){yt&&function(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}(yt,t)}(h);for(const t in o)o[t]()}),isMounted:()=>Boolean(n)};return h}function Pt(t){const e={},n=[];for(let i in t){const r=t[i];Z(i)&&(W[i]&&(i=W[i]),n.push(i),i=N(i));let o=Array.isArray(r)?r[0]:r;const a=H.get(i);a&&(o=b(r)?a.toDefaultUnit(r):r),e[i]=o}return n.length&&(e.transform=G(n)),e}var kt=t=>t instanceof Element;function Vt(t,e){if(e(t))return t;if("function"==typeof t&&!t.length)return Vt(t(),e);if(Array.isArray(t))for(const n of t){const t=Vt(n,e);if(t)return t}return null}function Lt(t,e=kt,n=kt){const i=r(t);return r((()=>Vt(i(),e)))}var Ct=()=>{},Rt=(t,e)=>e();var $t=/([^:; ]*):\s*([^;]*)/g;function Bt(t){const e={};let n;for(;n=$t.exec(t);)e[n[1]]=n[2];return e}const It=u(),qt=e=>{let n=!1!==e.initial;const i=t(It.Provider,{value:()=>n,get children(){return t(Nt.Provider,{value:void 0,get children(){return function(t,e){const n=o(t),i=n?[n]:[],{onEnter:r=Rt,onExit:u=Rt}=e,[f,h]=a(e.appear?[]:i),[p]=s();let d,m=!1;function y(t,e){if(!t)return e&&e();m=!0,u(t,(()=>{l((()=>{m=!1,h((e=>e.filter((e=>e!==t)))),e&&e()}))}))}function v(t){const e=d;if(!e)return t&&t();d=void 0,h((t=>[e,...t])),r(e,t??Ct)}const g="out-in"===e.mode?t=>m||y(t,v):"in-out"===e.mode?t=>v((()=>y(t))):t=>{v(),y(t)};return c((e=>{const n=t();return o(p)?(p(),e):(n!==e&&(d=n,l((()=>o((()=>g(e)))))),n)}),e.appear?void 0:n),f}(Lt((()=>e.children)),{appear:n,mode:e.exitBeforeEnter?"out-in":"parallel",onExit(t,e){const n=jt.get(t);n&&n.getOptions().exit?Ut(t,e):e()}})}})}});return n=!0,i},Ut=(t,e)=>t.addEventListener("motioncomplete",e);function Ft(t,e,n,i){const r=Mt(!1===n?.()?{...e(),initial:!1}:e(),i);return p((()=>{const i=r.mount(t());d((()=>{n&&e().exit?(r.setActive("exit",!0),Ut(t(),i)):i()})),M(e)&&m((()=>r.update(e())))})),[r,Pt(r.getTarget())]}function Wt(t,e,n){const[i,r]=Ft((()=>t),"function"==typeof e?e:()=>e,n);for(const e in r)lt(t,e,r[e]);return i}function _t(t,e){Wt(t,e,f(It))}const zt=["initial","animate","inView","inViewOptions","hover","press","variants","transition","exit"],Ht=["tag","ref","style","onMotionStart","onMotionComplete","onHoverStart","onHoverEnd","onPressStart","onPressEnd","onViewEnter","onViewLeave"],Nt=u(),Kt=r=>{const[o,,a]=h(r,zt,Ht),[s,c]=Ft((()=>l),(()=>({...o})),f(It),f(Nt));let l;return t(Nt.Provider,{value:s,get children(){return t(n,e({ref:t=>{l=t,r.ref?.(t)},get component(){return r.tag||"div"},get style(){return i((()=>!!r.style),!0)()?(t=r.style,e=c,"object"==typeof t&&"object"==typeof e?{...t,...e}:"string"==typeof t&&"string"==typeof e?`${t};${e}`:{..."object"==typeof t?t:Bt(t),..."object"==typeof e?e:Bt(e)}):c;var t,e},get"on:motionstart"(){return r.onMotionStart},get"on:motioncomplete"(){return r.onMotionComplete},get"on:hoverstart"(){return r.onHoverStart},get"on:hoverend"(){return r.onHoverEnd},get"on:pressstart"(){return r.onPressStart},get"on:pressend"(){return r.onPressEnd},get"on:viewenter"(){return r.onViewEnter},get"on:viewleave"(){return r.onViewLeave}},a))}})},Xt=new Proxy(Kt,{get:(n,i)=>n=>t(Kt,e(n,{tag:i}))});export{Xt as Motion,qt as Presence,It as PresenceContext,Wt as createMotion,_t as motion};
